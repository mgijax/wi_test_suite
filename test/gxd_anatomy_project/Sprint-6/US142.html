<html xmlns:concordion="http://www.concordion.org/2007/concordion" xmlns:cc="http://fewi.custom.commands.FewiExtensions">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<style>
	table {border-collapse: collapse; padding-bottom:5px; margin-bottom:5px;}
	table, th, td {border: 1px solid #CCCCCC;}
	td, th {padding:2px;}
	.man {background-color:#FFFFCC;}
	ul {padding: 0px; padding-bottom:3px; padding-top:0px; margin: 0px;}
	ol {padding: 0px; padding-bottom:3px; padding-top:0px; margin: 0px;}
	li {padding-left:2px; padding-top:0px; padding-bottom:0px; margin-left:25px;}
	p {margin:2px 0px;}
</style>

    <title>User Story 142</title>
</head>

<body>

<div id="maintitle"><h1>Add filters to the GXD Result Summary</h1>
    <ul>
        <li>User Story 142 - Add filters to the GXD Result Summary</li>
      
    </ul>
</div><div id="TOC">
	<p>Contents: <a href="#maintitle">Title</a> | <a href="#acceptance">Test Requirements</a> | <a href="#manual">Manual Tests</a> | <a href="#sql">SQL Tests</a></p>
</div>



<div id="acceptance">
    <h2>Test Requirements</h2>
	<ol>
	   <li>Add filter option for selected fields on the GXD Results Summary to provide the user an additional way to narrow down results.
	   <ol><li>Anatomical System: 24 options - adipose tissue, alimentary system, branchial arches, cardiovascular system, cavities & their linings, early embryo, embryo-other, endocrine system, extraembryonic component, head, hemolymphoid system, integumental system, limbs, liver & biliary system, mesenchyme, muscle, nervous system, postnatal-other, renal & urinary system, reproductive system, respiratory system, sensory organs, skeletal system, tail </li>
	       <li>Assay Type: Immunohistochemistry, In situ reporter (knock-in), Norther blot, Nuclease S1, RNA in situ, RNA protection, RT-PCR, Western blot</li>
	   </ol></li>
	   <li>All the filter options are present at the top of each tab on the GXD Summary page - and should filter all the tabs at the same time: Results, Assays, Genes, and Images. (per GXD meeting - 1/24)
	   <ul><li>See the reference QF re: placement/style of filter buttons</li></ul></li>
	   <li>The filter options are present at the top of all versions of the GXD Summary pages listed below.  The type of heading present on each page is included for informational purposes.
	   <ol><li>Query Form Summaries - Standard QF (query results header w/ You Searched For)</li>
	       <li>Query Form Summaries - Differential QF (query results header w/ You Searched For)
	       <ul><li>Note - the default tab is Genes (not Results) for these Summaries</li></ul></li>
	       <li>by Marker (marker header)</li>
	       <li>by Marker/Assay Type (marker header + "Data Summary" w/assay type)</li>
	       <li>by Marker/Theiler Stage (marker header + "Data Summary" w/TS)</li>
	       <li>by EMAPA/EMAPS terms (structure header)</li>
	       <li>by Allele (allele header)</li>
	       <li>by Reference (J# header)</li>
	       <li>by Marker/Structure - link from BQ and Marker Tissue (no header - US 141)</li>
	       <li>by Marker/J# - link from GXD Lit (no header)</li>
	       <li>by Probe (no header)</li>
	       <li>by Antibody (no header)</li>
	       <li>others?</li>
	   </ol></li>
	   <li>Filters work on the "bucket" of data contained on the original Summary (either from QF or other specific summaries)
	   <ul><li>Rerunning the Query Form search with new or the same parameters removes all filters -- resets the "bucket" of data.</li></ul></li>
	   <li>Filters are limited to the items present in the initial "bucket" of data and continually change as filters are added/removed
	   <ol><li>When at least 1 item is checked for a filter and executed - the filter list will only include the checked items</li>
	       <li>When all previously checked items are unchecked for a filter and executed - the original filter list will return</li>
	       <li>Filtering items in 1 field may reduce the items to filter by in another.</li>
	   </ol></li>
	   <li>Users may select 1 or more items for each filter available.</li>
	   <li>User may un-select 1 or more items for each filter available.
	   <ul><li>Provide two options: button at top of page or un-check of box within Filter</li></ul></li>
	   <li>Display special filter message in the heading  of all the Summary pages per Reference Summary style (text that specifically notes objects removed).
	   <ul><li>message = "Filters:  No filters selected."</li>  </ul></li>
	   <li>Provide users a list of filters selected in the heading of the Summary page as part of each filter event.
	   <ul><li>Each item is displayed as a button and also acts as an "undo" for the user.</li></ul></li>
	   <li>Provide users the option to remove all filters in 1 step.</li>
	   <li>Provide users with updated counts each time a filter is added/removed
	   <ul><li>Applicable for all 4 GXD Summaries: Gene, Assay, Results, Image</li>
	       <li>Per GXD meeting on 1/24 - display the filtered counts in the Tabs</li>
	       <li>Per GXD meeting on 1/24 - no need to display original counts of summary (as the Reference Summary does)</li>
	   </ul></li>
	   <li>Pagination counts and controls are updated after each filter event for all GXD Summaries</li>
	   <li>You searched for values continue to be displayed during the filter events and are not changed.</li>
	   <li>Use the Reference QF as a guide to the UI display as applicable.</li>
       <li>Filters should work properly in all supported browsers (IE, Firefox, Safari)</li>
       
	</ol>
</div>
 
 <div id="tests">
    <h2>Tests</h2>
    
	<div id="manual">
<!-- To insert manual test results, use the following:
<p concordion:assertTrue="true">testing assertTrue - displays as green</p>
<p concordion:assertTrue="false">testing assertFalse - displays as red</p>
 -->
		<h3>Manual tests</h3>
		
		<ol>
    		
    		<li>Verify all the versions of the GXD Summary pages display the filters on each Summary Tab and "filter text" in heading area. (req 1,2,3,8)
    		<p concordion:assertTrue="false">new test</p>  
    		<ol><li>Standard QF Summary</li>
	            <li>Differential QF Summary</li>
	            <li>by Marker</li>
	            <li>by Marker/Assay Type - link on Marker Detail</li>
	            <li>by Marker/Theiler Stage - link on Marker Detail</li>
	            <li>by EMAPA term - link on QS, Anatomy Browser</li>
	            <li>by EMAPS term - link on Anatomy Browser, Assay Detail</li>
	            <li>by Allele - e.g. A&lt;y&gt;   </li>
	            <li>by Reference</li>
	            <li>by Marker/Structure - link from BQ and Marker Tissue</li>
	            <li>by Marker/J# - link from GXD Lit</li>
	            <li>by Probe - e.g. MGI:2670297</li>
	            <li>by Antibody - e.g. MGI:1330766</li>
    		    
    		</ol></li>
    		
    		<li>Verify Anatomical System initial filter - counts - pagination displays as expected via Std QF. (reqs 1,4)
    		<p concordion:assertTrue="false">new test</p>  
    		<ol><li>Perform a query that will return results that include all Anatomical Systems.  Query = xxxxx.  Expect: filter to list them all.</li>
    		    <li>Perform a query that will return results that include only 1 Anatomical System.  Query = xxxxx.  Expect: filter to list just that item.</li>
    		    <li>Perform a query that will return results that include multiple Systems, but not all.  Query = xxxx.  Expect: filter to list correct subset of systems.</li>
    		</ol>
    		<ul><li>TERMS for each SYSTEM - list for testing</li>
    		    <li>adipose tissue terms: adipose tissue, brown fat, white fat, etc. (only stage 28)</li>
    		    <li>alimentary system terms: gut endoderm, intestine, lip, lower jaw,  etc. (stages 12-26)</li>
    		    <li>branchial arches terms: 1st branchial groove, branchial pouch, 1st branchial arch maxillary-mandibular groove,  etc. (stages 12-19) </li>
    		    <li>cardiovascular system terms: 1st arch artery,  right atrium, iliac artery, etc (stages 12-28)</li>
    		    <li>cavities & their linings terms: greater sac, pericardial cavity, pleural cavity (stages 08-28) </li>
    		    <li>early embryo terms: epiblast, second polar body, node  (stages 01-10)</li>
    		    <li>embryo-other terms: axial skeleton, definitive endoderm, cranium  (stages 11-27) </li>
    		    <li>endocrine system terms:  thyroid gland, gland, pancreas body  (stages 22-28) </li>
    		    <li>extraembryonic component terms:  yolk sac, Reichert's membrane, common umbilical vein (stages 4-26)</li>
    		    <li>head terms: snout, face, head (stages 12-28) </li>
    		    <li>hemolymphoid system terms: mediastinal lymph node, blood, plasma (stages 23-28)</li>
    		    <li>integumental system terms: brown fat, hair, nail bed (stages 11-28)</li>
    		    <li>limbs terms:  ankle, knee joint, lower leg (stages 14-28)</li>
    		    <li>liver & biliary system terms: common bile duct, liver lobe, liver vascular element (stages 16-28) </li>
    		    <li>mesenchyme terms:  body-wall mesenchyme, somite, trunk somite (stages 11-26)</li>
    		    <li>muscle terms: deltoid, pelvic girdle musculature (stages 21-28) </li>
    		    <li>nervous system terms:  future brain, brain pia mater, brainstem nucleua (stages 11-28)</li>
    		    <li>postnatal-other terms:  bone, back muscle, ligament (stage 28)</li>
    		    <li>renal & urinary system terms: renal artery, maturing nephron, metanephros (stages 19-28) </li>
    		    <li>reproductive system terms:  ovary, placenta, prostate gland (stages 19-28) </li>
    		    <li>respiratory system terms: left lung, vocal folds, lung (stages 15-28) </li>
    		    <li>sensory organs terms: medial-nasal process, hyaloid cavity, eye gland (stages 12-28)</li>
    		    <li>skeletal system terms: axial skeleton, C1 vertebra, vault of skull (stages 15-26)</li>
    		    <li>tail terms: pancreas tail, unsegmented mesenchyme, tail nervous system (stages 15-26)</li>
    		    
    		</ul></li>
    		
    		<li>Verify Assay Type initial filter - counts - pagination displays as expected via Std QF. (reqs 1,4)
    		<p concordion:assertTrue="false">new test</p>  
    		<ol><li>Perform a query that will return results that include all Assay Types.  Query = xxxxx.  Expect: filter to list them all.</li>
    		    <li>Perform a query that will return results that include only 1 Assay Type.  Query = xxxxx.  Expect: filter to list just that item.</li>
    		    <li>Perform a query that will return results that include multiple Assay Types, but not all.  Query = xxxx.  Expect: filter to list correct subset of assays.</li>
    		</ol></li>
    		
    		<li>Verify Anatomical System initial filter - counts - pagination displays as expected via Differential QF. (reqs 1,4)
    		<p concordion:assertTrue="false">new test</p>  
    		<ol><li>Perform a query that will return results that include all Anatomical Systems.  Query = xxxxx.  Expect: filter to list them all.</li>
    		    <li>Perform a query that will return results that include only 1 Anatomical System.  Query = xxxxx.  Expect: filter to list just that item.</li>
    		    <li>Perform a query that will return results that include multiple Systems, but not all.  Query = xxxx.  Expect: filter to list correct subset of systems.</li>
    		</ol></li>
    		
    		<li>Verify Assay Type initial filter - counts - pagination displays as expected via Differential QF. (reqs 1,4)
    		<p concordion:assertTrue="false">new test</p>  
    		<ol><li>Perform a query that will return results that include all Assay Types.  Query = xxxxx.  Expect: filter to list them all.</li>
    		    <li>Perform a query that will return results that include only 1 Assay Type.  Query = xxxxx.  Expect: filter to list just that item.</li>
    		    <li>Perform a query that will return results that include multiple Assay Types, but not all.  Query = xxxx.  Expect: filter to list correct subset of assays.</li>
    		    
    		</ol></li>
    		
    		<li>Verify Anatomical System filter - add/remove items - counts updated. (req 6,7, 11)
    		<p concordion:assertTrue="false">new test</p>  
    		<ol><li>Filter by 1 item - verify updated counts on all summary tabs.</li>
    		    <li>Remove filter just added - verify counts return to the original numbers.</li>
    		    <li>Filter by all items in filter list - verify counts stay the same.</li>
    		    <li>Remove filters just added - verify counts stay the same.</li>
    		    <li>Filter by 3 items - verify updated counts on all summary tabs.</li>
    		    <li>Remove 1 of the items - verify updated counts on all summary tabs.</li>
    		    <li>Remove remaining items - verify counts return to the original numbers.</li>
    		</ol></li>
    		
    		<li>Verify Assay Type filter initial filter - add/remove items - counts updated.  (req 6,7, 11)
    		<p concordion:assertTrue="false">new test</p>  
    		<ol><li>Filter by 1 item - verify updated counts on all summary tabs.</li>
    		    <li>Remove filter just added - verify counts return to the original numbers.</li>
    		    <li>Filter by all items in filter list - verify counts stay the same.</li>
    		    <li>Remove filters just added - verify counts stay the same.</li>
    		    <li>Filter by 3 items - verify updated counts on all summary tabs.</li>
    		    <li>Remove 1 of the items - verify updated counts on all summary tabs.</li>
    		    <li>Remove remaining items - verify counts return to the original numbers.</li>
    		</ol></li>
    		
    		<li>Verify filtering by Assay Type alters options in Anatomical System filter (req 5)
    		<p concordion:assertTrue="false">new test</p>  
    		<ol><li>Filter by Assay Types that do not change the list of Anatomical Systems. Verify list after filter.</li>
    		    <li>Filter by Assay Types that remove 1 item from the Anatomical Systems filter.  Verify list.</li>
    		    <li>Filter by Assay Types that remove all but 1 item from the Anatomical Systems filter.  Verify list.</li>
    		</ol></li>
    		
    		<li>Verify filtering by Anatomical System alters options in Assay Type filter (req 5)
    		<p concordion:assertTrue="false">new test</p>  
    		<ol><li>Filter by Anatomical Systems that do not change the list of Assay Types. Verify list after filter.</li>
    		    <li>Filter by Anatomical Systems that remove 1 item from the Assay Types filter.  Verify list.</li>
    		    <li>Filter by Anatomical Systems that remove all but 1 item from the Assay Types filter.  Verify list.</li>
    		</ol></li>
    		
    		<li>Verify list of filters displayed in the heading and "undo" functionality (req 9)
    		<p concordion:assertTrue="false">new test</p>  
    		<ol><li>Filter by 1 Assay item.  Select undo button.</li>
    		    <li>Filter by 1 System item.  Select undo button.</li>
    		    <li>Filter by multiple Assay and System items.  Undo some of each.  Verify results.</li>
    		    <li>Filter by all Assay items.  Undo all of them.  Verify results.</li>
    		    <li>Filter by all System items.  Undo all of them.  Verify results.</li>
    		    <li>Filter for each item in both filters in random order - multiple filter operations.  Verify display.  Undo selected ones.  Verify.</li>
    		</ol></li>
    		
    		<li>Verify pagination works as expected as filters added/removed (req 12)
    		<p concordion:assertTrue="false">new test</p>  
    		<ol><li>Filter by Assay and verify the pagination on all 4 tabs.  Verify the pagination counts/controls.</li>
    		    <li>FIlter by System and verify the pagination on all 4 tabs.  Verify the pagination counts/controls.</li>
    		    <li>Filter by both Assay and System and verify the pagination on all 4 tabs.  Verify the pagination counts/controls.</li>
    		    <li>Remove some of the filters selected.  Verify the pagination counts/controls.</li>
    		    <li>Remove all of the filters selected.  Verify the pagination counts/controls.</li>   
    		</ol></li>
    		
    		<li>Verify "remove all filters" button (req 10)
    		<p concordion:assertTrue="false">new test</p>  
    		<ol><li>Filter 1 item from Assay filter.  Remove all filters.</li>
    		    <li>Filter multiple items from Assay filter.  Remove all filters.</li>
    		    <li>Filter 1 item from System filter.  Remove all filters</li>
    		    <li>Filter multiple items from System filter.  Remove all filters</li>
    		    <li>Filter items from both filters -- remove all filters.</li>
    		</ol></li>
    		
    		<li>Verify re-run of Query Form removes all filters (req 4)
    		<p concordion:assertTrue="false">new test</p>  
    		<ol><li>Use Std QF to produce GXD Summary - filter at least 1 item.  Re-run the query.  Expect: all filters removed for new summary.</li>
    		    <li>Use Std QF to produce GXD Summary - filter at least 1 item.  Modify the query params and re-run query.  Expect: all filters removed on new summary.</li>
    		    <li>Use Differential QF to produce GXD Summary - filter at least 1 item.  Re-run query.  Expect: all filters removed.</li>
    		    <li>Use Differential QF to produce GXD Summary - filter at least 1 item.  Modify query params and re-run query.  Expect:  all filters removed</li>
    		</ol></li>
    		
    		<li>Verify Filter items with special characters work as expected (ampersand, hyphen, parens)
    		<p concordion:assertTrue="false">new test</p>
    		<ol><li>Filter by item that includes ampersand; cavities & their linings.  Expect: data with this system returned.</li>
    		    <li>Filter by item that includes hyphen; RT-PCR.  Expect: data with this assay returned.</li>
    		    <li>Filter by item that includes parens; in situ reporter (knock-in).  Expect:  data with this assay returned.</li>
    		    <li>Remove filter for item that includes ampersand; renal & urinary system.  Expect: item no longer filtered</li>
    		    <li>Remove filter for item that includes hyphen; embryo-other.  Expect: item no longer filtered.</li>
    		    <li>Remove filter for item that includes parens; in situ reporter (knock-in).  Expect: item no longer filtered</li>
    		</ol></li>
    		
    		
    		<li>Verify filters works as expected on all supported browsers (IE, Safari, Firefox) (req 15)</li>
    		<p concordion:assertTrue="false">new test</p>  
    		
    		
		</ol>
	</div>
	<div id="sql">
	
	
 <!--  EXAMPLE TEST CASE USING DYNAMIC DATA SPREADSHEET AT https://docs.google.com/spreadsheet/ccc?key=0ArepxibBtJW2dEl0eEg1bElOc1Mxc1FnNGtmSmlUSlE#gid=2 
     			<li>
    			Query for <b concordion:set="#structure">4-cell stage</b> should return 
    			<b cc:assertEquals="getResultCount(#structure)"><b cc:dynamicData="countFor4CellStageResults"></b></b> assay results, 
    			<b cc:assertEquals="getAssayCount(#structure)"><b cc:dynamicData="countFor4CellStageAssays"></b></b> assays, 
    			and <b cc:assertEquals="getGeneCount(#structure)"><b cc:dynamicData="countFor4CellStageGenes"></b></b> genes.<br/></li>
  -->
 	</div>
</div>

</body>
</html>